<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="org.alex.platform.mapper.RelyDataMapper">
    <insert id="insertRelyData" parameterType="org.alex.platform.pojo.RelyDataDO">
       insert into `t_rely_data`
       <trim prefix="(" suffix=")" suffixOverrides=",">
           <if test="name!=null">`name`,</if>
           <if test="value!=null">`value`,</if>
           <if test="desc!=null">`desc`,</if>
           <if test="type!=null">`type`,</if>
           <if test="datasourceId!=null">`datasource_id`,</if>
           <if test="createdTime!=null">`created_time`,</if>
           <if test="updateTime!=null">`update_time`,</if>
       </trim>
       <trim prefix="value(" suffix=")" suffixOverrides=",">
           <if test="name!=null">#{name},</if>
           <if test="value!=null">#{value},</if>
           <if test="desc!=null">#{desc},</if>
           <if test="type!=null">#{type},</if>
           <if test="datasourceId!=null">#{datasourceId},</if>
           <if test="createdTime!=null">#{createdTime},</if>
           <if test="updateTime!=null">#{updateTime},</if>
       </trim>
    </insert>
    <update id="updateRelyData" parameterType="org.alex.platform.pojo.RelyDataDO">
        update `t_rely_data`
        <set>
            <if test="name!=null">`name`=#{name},</if>
            <if test="value!=null">`value`=#{value},</if>
            <if test="desc!=null">`desc`=#{desc},</if>
            <if test="type!=null">`type`=#{type},</if>
            <if test="datasourceId!=null">`datasource_id`=#{datasourceId},</if>
            <if test="createdTime!=null">`created_time`=#{createdTime},</if>
            <if test="updateTime!=null">`update_time`=#{updateTime},</if>
        </set>
        where `id` = #{id}
    </update>
    <select id="selectRelyDataById" parameterType="Integer" resultType="org.alex.platform.pojo.RelyDataVO">
        select `rd`.`id`,`rd`.`name`,`rd`.`value`,`rd`.`desc`,`rd`.`type`,`rd`.`datasource_id`,
        `db`.`name` as `db_name`,`rd`.`created_time`,`rd`.`update_time`
        from `t_rely_data` as `rd`
        left join t_db as `db`
        on `rd`.`datasource_id` = `db`.`id`
        where `rd`.`id` = #{id}
    </select>
    <select id="selectRelyDataByName" parameterType="String" resultType="org.alex.platform.pojo.RelyDataVO">
        select `rd`.`id`,`rd`.`name`,`rd`.`value`,`rd`.`desc`,`rd`.`type`,`rd`.`datasource_id`,
        `db`.`name` as `db_name`,`rd`.`created_time`,`rd`.`update_time`
        from `t_rely_data` as `rd`
        left join t_db as `db`
        on `rd`.`datasource_id` = `db`.`id`
        where `rd`.`name` = #{name}
    </select>
    <select id="selectRelyDataList" parameterType="org.alex.platform.pojo.RelyDataDTO" resultType="org.alex.platform.pojo.RelyDataVO">
        select `rd`.`id`,`rd`.`name`,`rd`.`value`,`rd`.`desc`,`rd`.`type`,`rd`.`datasource_id`,
        `db`.`name` as `db_name`,`rd`.`created_time`,`rd`.`update_time`
        from `t_rely_data` as `rd`
        left join t_db as `db`
        on `rd`.`datasource_id` = `db`.`id`
        <where>
            <if test="id!=null">and `rd`.`id`=#{id}</if>
            <if test="name!=null">and `rd`.`name` like concat('%',#{name},'%')</if>
            <if test="value!=null">and `rd`.`value` like concat('%',#{value},'%')</if>
            <if test="desc!=null">and `rd`.`desc` like concat('%',#{desc},'%')</if>
            <if test="type!=null">and `rd`.`type`=#{type}</if>
            <if test="datasourceId!=null">and `rd`.`datasource_id`=#{datasourceId}</if>
            <if test="dbName!=null">and `db`.`name` like concat('%',#{dbName},'%')</if>
            <if test="createdTime!=null">and `rd`.`created_time` &gt;= #{createdTime}</if>
            <if test="updateTime!=null">and `rd`.`update_time` &lt;= #{updateTime}</if>
        </where>
    </select>
    <delete id="deleteRelyDataById" parameterType="Integer">
        delete from `t_t_rely_data` where id = #{id}
    </delete>
</mapper>